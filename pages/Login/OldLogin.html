<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | DU</title>
    <link rel="stylesheet" href="../../css/login.css">
    <style>
    </style>

    <script>
        var ServerUrl = "https://developers-union-nodeback.sifecleak.repl.co";
        const anplay = { long: "1" }//动画属性时长：long(单位：秒)
        function animate(el, params, speed) {//speed是以秒为单位的数字
            el.style.transition = 'all ' + speed + 's';
            Object.keys(params).forEach((key) => {
                el.style[key] = params[key];
            });
        };
    </script>
</head>

<body>
    <div id="mess">
        <div id="box">
            <span>邮箱</span><input id="email" class="in" /><br>
            <span>密码</span><input id="pwd" class="in" /><br>
            <button id="send">发送</button>
        </div>
    </div>
    <p id="notc"
        style="color:white;position: fixed;padding:10px 20px;width: fit-content;border-radius:16px;border: 1px solid rgb(122, 122, 122);">
    </p>
    <script>
        $("#pwd").onfocus = $("#email").onfocus = function () {
            animate(this, { "border-bottom": "1px solid blue" }, "0.5")
        }
        $("#pwd").onblur = $("#email").onblur = function () {
            animate(this, { "border-bottom": "1px solid white" }, "0.5")
        }
    </script>
    <script type="module">
        function notice(str, colors) { $('#notc').style.backgroundColor = colors; animate($('#notc'), { 'top': '40px' }, '0.5'); $('#notc').innerText = str; $('#notc').style.left = 'calc(50% - ' + ($('#notc').offsetWidth) / 2 + 'px' + ')'; var s = setTimeout(function () { animate($('#notc'), { 'top': '-100px' }, '0.5'); clearTimeout(s) }, 3000); }//notice提示
        import { md5_$ } from "../tools/md5.js";
        import { cookie } from "../tools/cookie.js";
        $("#send").onclick = () => {
            fetch(ServerUrl + '/api/v0/login', { method: 'POST', body: JSON.stringify({ 'email': $("#email").value, "t": Date.now(), "password": md5_$($("#pwd").value) }) }).then(r => r.json()).then(i => { notice(i.msg, "black"); cookie.set("token", i.token, 1); cookie.set("id", String(i.main.id), 1) });
        }
    </script>
</body>

</html>